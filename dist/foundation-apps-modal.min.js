"use strict";angular.module("zfaModal",["foundation"]).provider("zfaModal",function(){function e(e,o){if("string"==typeof e)return o.id=e,a[e]=o;throw new Error("zfaModalProvider: modalId should be defined")}var a={};return{register:e,$get:["zfaModalFactory","FoundationApi",function(o,l){return{open:function(l,t){var r=a[l]||e(l,t);return r.locals=angular.extend({},r.locals,t),o.createModal(r)},close:function(e){l.publish(e,"close")}}}]}}),angular.module("zfaModal").config(["zfaModalProvider",function(e){for(var a=[{id:"alert",config:{controller:["$scope","ok","message",function(e,a,o){e.ok=a,e.message=o}],template:'<div zf-modal="" overlay="true" overlay-close="true" class="tiny dialog"><a class="close-button" zf-close="">x</a><h4>{{message}}</h4><a class="button primary" ng-click="resolve()">{{ok}}</a></div>',locals:{ok:"OK",message:""}}},{id:"confirm",config:{controller:["$scope","ok","cancel","message",function(e,a,o,l){e.ok=a,e.cancel=o,e.message=l}],template:'<div zf-modal="" overlay="true" overlay-close="true" class="tiny dialog"><a class="close-button" zf-close="">x</a><h4>{{message}}</h4><a class="button primary" ng-click="resolve()">{{ok}}</a><a class="button secondary" ng-click="reject()">{{cancel}}</a></div>',locals:{ok:"OK",cancel:"Cancel",message:""}}},{id:"prompt",config:{controller:["$scope","ok","cancel","message","value",function(e,a,o,l,t){e.ok=a,e.cancel=o,e.message=l,e.value=t}],template:'<div zf-modal="" overlay="true" overlay-close="true" class="tiny dialog"><a class="close-button" zf-close="">x</a><h4>{{message}}</h4><label><input type="text" ng-model="value"></label><a class="button primary" ng-click="resolve(value)">{{ok}}</a><a class="button secondary" ng-click="reject()">{{cancel}}</a></div>',locals:{ok:"OK",cancel:"Cancel",message:"",value:""}}}],o=0;o<a.length;o++)e.register(a[o].id,a[o].config)}]),angular.module("zfaModal").factory("zfaModalFactory",["FoundationApi","$controller","$rootScope","$http","$q","$compile","$timeout","$window","$templateCache",function(e,a,o,l,t,r,n,c,s){function i(i){var u,d=t.defer();if(i.templateUrl)u=s.get(i.templateUrl),u?d.resolve(Array.isArray(u)?u[1]:u):l.get(i.templateUrl,{cache:s}).then(function(e){d.resolve(e.data)});else{if(!i.template)throw new Error("zfaModal: template should be defined");d.resolve(i.template)}return d.promise.then(function(l){var s=t.defer(),u=i.id||e.generateUuid(),d=angular.element(l).attr("id",u),f={animationIn:"animation-in",animationOut:"animation-out",overlay:"overlay",overlayClose:"overlay-close"};for(var m in f)f.hasOwnProperty(m)&&void 0!==i[m]&&d.attr(f[m],i[m]);var v=i.container||c.document.body;angular.element(v).append(d);var g=o.$new();return g.active=!0,g.resolve=s.resolve.bind(s),g.reject=s.reject.bind(s),r(d)(g),i.controller&&a(i.controller,angular.extend({},i.locals,{$scope:g,zfaModalDefer:s})),e.publish(u,"show"),e.subscribe(u,function(a){switch(a){case"toggle":if(!g.active)break;case"close":case"hide":s.reject(a),n(function(){d.remove(),g.$destroy()},3e3),e.unsubscribe(u)}}),s.promise["finally"](function(){e.publish(u,"close"),e.unsubscribe(u)}),s.promise})}return{createModal:i}}]);